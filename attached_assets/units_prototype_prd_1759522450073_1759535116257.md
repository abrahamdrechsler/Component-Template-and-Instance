# PRD: Units Prototype

## 1. Overview

The **Units Prototype** is a 2D drafting and configuration environment
for creating, saving, publishing, and linking unit-based designs. The
prototype enables users to draw **rectangular rooms**, group them into
**Component Templates**, place **Component Instances**, and manage
references across multiple files.

The system enforces strict **1' grid snapping** for both positioning and
sizing, ensuring all geometry is modular and consistent. Users can
publish design files to a central configuration database ("Config") and
link files to enable central updates of unit templates across projects.

------------------------------------------------------------------------

## 2. Goals & Non-Goals

### Goals

-   Provide a lightweight 2D drafting plane for creating rectangular
    rooms.\
-   Enforce a **1' x 1' grid system** for all geometry.\
-   Support grouping of rooms into **Component Templates** and placing
    **Component Instances**.\
-   Provide an **Inspector Panel** listing all rooms, templates, and
    links.\
-   Allow publishing files with metadata (name, publish time, number of
    units).\
-   Support linking between files, importing templates, and centrally
    updating linked units.

### Non-Goals

-   3D modeling or complex geometry.\
-   Full CAD functionality (advanced annotations, constraints,
    dimensions).\
-   Real-time multi-user collaboration (out of scope for prototype).

------------------------------------------------------------------------

## 3. Core Features

### 3.1 Drafting Plane

-   **Grid System**:
    -   Canvas displays a **1' x 1' (12" x 12") grid**.\
    -   All positions and dimensions must be whole-foot multiples.\
    -   No off-grid placement or partial-foot dimensions.
-   **Drawing Rectangles (Rooms)**:
    -   Represent rooms.\
    -   Snap to grid intersections.\
    -   Width and height must be whole feet (e.g., 12' x 15' is valid,
        12'6" x 15' is invalid).\
    -   No overlapping allowed.\
    -   Rectangles can snap edge-to-edge along grid lines.
-   **Movement & Resizing**:
    -   Rectangles move in 1' increments.\
    -   Resizing adjusts dimensions in 1' increments only.\
    -   Always grid-aligned.

### 3.2 Component Templates & Instances

-   **Component Template**:
    -   Saved grouping of rectangles.\
    -   User can select multiple rectangles and "Save as Template."\
    -   Templates appear in Inspector under "Component Templates."
-   **Component Instance**:
    -   A placed occurrence of a Component Template.\
    -   The first grouped selection automatically becomes a Component
        Instance.\
    -   Instances remain grid-aligned and update when source template
        changes.

### 3.3 Inspector Panel (Left Sidebar)

-   **Rooms**: List of all rectangles in the file (name, dimensions,
    position).\
-   **Component Templates**: List of saved templates.\
-   **Links**: Shows external linked files and imported templates.

### 3.4 File Publishing

-   **Publish Action**: Sends file data to **Config** database.\
-   **File Metadata Stored**:
    -   File Name (set in editor).\
    -   Timestamp of publication.\
    -   Number of Unit Instances in file ("number of units").\
-   **Database Management Page**:
    -   Lists all published homes.\
    -   Shows file name, publish time, and number of units.

### 3.5 Linking & Referencing

-   **Attach Published Files**: Users can link another published file.\
-   **Import Templates**: Select one or more Component Templates from
    linked file to bring into local file.\
-   **Notifications**:
    -   If parent file updates, local file shows warning in Links
        section.\
    -   User must click "Update" to pull changes.\
-   **Central Updates**: Enable one source file to propagate unit
    changes across downstream projects.

------------------------------------------------------------------------

## 4. User Flows

### Flow A: Creating Rooms & Templates

1.  User opens canvas with 1' grid.\
2.  Draws 3 rectangles (all sized/moved in whole feet).\
3.  Selects 2 rectangles → Save as Component Template.\
4.  Inspector updates:
    -   "Rooms" lists 3 entries.\
    -   "Component Templates" lists new template.\
5.  Selected group becomes a **Component Instance**.

### Flow B: Publishing a File

1.  User sets file name ("Sample Home A").\
2.  Clicks **Publish**.\
3.  Data sent to Config with timestamp, file name, and number of units.\
4.  Database page displays:
    -   Sample Home A\
    -   Published time\
    -   Unit count

### Flow C: Linking Files

1.  User opens File B.\
2.  In **Links**, attaches File A (already published).\
3.  Selects 2 Component Templates from File A to import.\
4.  Templates appear in File B Inspector under "Component Templates
    (Linked).").\
5.  Later, File A updates.\
6.  File B Inspector shows warning: "File A has updates."\
7.  User clicks **Update** → templates refresh to latest version.

------------------------------------------------------------------------

## 5. Technical Requirements

### Data Model

-   **Room** = {id, name, width_ft, height_ft, x_ft, y_ft}.\
-   **Component Template** = {id, name, member_rooms\[\],
    source_file_id}.\
-   **Component Instance** = {id, template_id, x_ft, y_ft}.\
-   **File** = {id, name, rooms\[\], templates\[\], links\[\]}.\
-   **Published File Metadata** = {id, name, timestamp, unit_count}.

### Grid Enforcement

-   All positions and dimensions must be multiples of 1'.\
-   Coordinate system uses feet (stored as integers).\
-   Drawing, moving, and resizing all enforce grid snapping.\
-   Validation blocks off-grid geometry.

### Linking System

-   References tracked by file ID + template ID.\
-   Local file shows warning state until user confirms update.\
-   Sync is user-controlled (manual update required).

------------------------------------------------------------------------

## 6. Future Considerations

-   3D visualization of units.\
-   Advanced snapping (midpoints, alignments, offsets).\
-   Constraints (parametric dimensions).\
-   Undo/redo.\
-   Version history for published files.
